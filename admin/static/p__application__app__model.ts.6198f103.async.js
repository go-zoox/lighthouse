(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{pnsH:function(e,t,a){"use strict";a.r(t);var r=a("Y/ft"),n=a.n(r),s=a("d6i3"),c=a.n(s),p=a("p0pE"),u=a.n(p),i=a("gE9T"),o=a("V/h/"),l=a("sy1d"),d=a("wlTG");t["default"]={namespace:d["e"].namespace,state:{attributes:{actions:d["a"],forms:d["d"],confirms:d["b"],filters:d["c"],tables:d["f"],pagination:{pageSizeOptions:["5","10","20"],current:1,pageSize:11,total:1}},datasets:{table:[]},constraints:{filters:{},orderBy:[]}},reducers:{save:(e,t)=>{var a=t.payload;return u()({},e,a)},"save/attributes":(e,t)=>{var a=t.payload;return u()({},e,{attributes:a})},"save/constraints":(e,t)=>{var a=t.payload;return u()({},e,{constraints:a})}},effects:{dispatcher(e,t){return c.a.mark(function a(){var r,n,s,p,u,i,o,l,d;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:if(r=e.payload,n=t.put,s=r||{},p=s.meta,u=void 0===p?{}:p,i=s.data,o=void 0===i?{}:i,l=u.effectType,d=void 0===l?"dialog":l,!u.effect){a.next=9;break}return a.next=7,n({type:u.effect,payload:o});case 7:a.next=11;break;case 9:return a.next=11,n({type:"".concat(d,"/").concat(u.key),payload:o});case 11:case"end":return a.stop()}},a)})()},"dialog/create"(e,t){return c.a.mark(function a(){var r,s,p,i,o,l,y;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload,s=t.select,p=t.put,a.next=4,s(e=>e[d["e"].namespace]);case 4:return i=a.sent,o=i.attributes,l="create",r.values,r.initialValue,y=n()(r,["values","initialValue"]),a.next=10,p({type:"forms/open",payload:{attributes:u()({},o.forms[l],{target:{namespace:d["e"].namespace,effect:"service/create"}}),datasets:u()({},y,{values:{}})}});case 10:case"end":return a.stop()}},a)})()},"dialog/copy"(e,t){return c.a.mark(function a(){var r,n,s,p,i,o,l;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload.record,n=t.select,s=t.put,a.next=4,n(e=>e[d["e"].namespace]);case 4:return p=a.sent,i=p.attributes,o="copy",l=u()({},r,{name:r.name+"_copy","client.client_id":r["client.client_id"]+"_copy"}),a.next=10,s({type:"forms/open",payload:{attributes:u()({},i.forms[o],{target:{namespace:d["e"].namespace,effect:"service/create"}}),datasets:{values:l}}});case 10:case"end":return a.stop()}},a)})()},"dialog/update"(e,t){return c.a.mark(function a(){var r,n,s,p,i,o;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload.record,n=t.select,s=t.put,a.next=4,n(e=>e[d["e"].namespace]);case 4:return p=a.sent,i=p.attributes,o="update",a.next=9,s({type:"forms/open",payload:{attributes:u()({},i.forms[o],{target:{namespace:d["e"].namespace,effect:"service/update"}}),datasets:{values:r}}});case 9:case"end":return a.stop()}},a)})()},"dialog/delete"(e,t){return c.a.mark(function a(){var r,n,s,p,i,o;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return e.type,r=e.payload.record,n=t.select,s=t.put,a.next=4,n(e=>e[d["e"].namespace]);case 4:return p=a.sent,i=p.attributes,o="delete",a.next=9,s({type:"confirms/open",payload:{attributes:u()({},i.confirms[o],{target:{namespace:d["e"].namespace,effect:"service/delete"}}),datasets:{values:r}}});case 9:case"end":return a.stop()}},a)})()},"service/query"(e,t){return c.a.mark(function a(){var r,n,s,p,y,v,f,m,x,w,h,g,b,k,q,S,z;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload,n=r.page,s=r.values,p=t.select,y=t.race,v=t.call,f=t.put,a.next=4,p(e=>e[d["e"].namespace]);case 4:if(m=a.sent,!s){a.next=8;break}return a.next=8,f({type:"save/constraints",payload:u()({},m.constraints,{filters:s})});case 8:return a.next=10,p(e=>e[d["e"].namespace]);case 10:return x=a.sent,w=x.attributes,h=x.datasets,g=x.constraints,b=w.pagination,k=n||b.current,a.next=18,y({data:v(l["a"],{method:"GET",path:"/api/resource/applications",query:u()({page:k,pageSize:b.pageSize},g.filters)}),timeout:v(i["delay"],1e4)});case 18:if(q=a.sent,S=q.data,z=q.timeout,!z){a.next=25;break}return a.next=24,f({type:"messages/notice/error",payload:"\u670d\u52a1\u5668\u5f00\u5c0f\u5dee\u5566"});case 24:return a.abrupt("return",!1);case 25:return a.next=27,f({type:"save",payload:{attributes:Object(o["a"])(w,e=>{e.pagination.current=k,e.pagination.total=S.total}),datasets:Object(o["a"])(h,e=>{e.table=S.data})}});case 27:case"end":return a.stop()}},a)})()},"service/create"(e,t){return c.a.mark(function a(){var r,n,s,p,o,d,y;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload,n=t.race,s=t.call,p=t.put,o=u()({},null===r||void 0===r?void 0:r.values),a.next=5,n({data:s(l["a"],{method:"POST",path:"/api/resource/applications",body:o}),timeout:s(i["delay"],1e4)});case 5:if(d=a.sent,d.data,y=d.timeout,!y){a.next=12;break}return a.next=11,p({type:"messages/tip/error",payload:"\u670d\u52a1\u5668\u5f00\u5c0f\u5dee\u5566"});case 11:return a.abrupt("return",!1);case 12:return a.next=14,p({type:"service/query/first/page",payload:r});case 14:case"end":return a.stop()}},a)})()},"service/update"(e,t){return c.a.mark(function a(){var r,n,s,p,o,d,y,v;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload.values,n=t.race,s=t.call,p=t.put,o=u()({},r),d={id:r._id},a.next=6,n({data:s(l["a"],{method:"PUT",path:"/api/resource/applications/:id",params:d,body:o}),timeout:s(i["delay"],1e4)});case 6:if(y=a.sent,v=y.timeout,!v){a.next=12;break}return a.next=11,p({type:"messages/tip/error",payload:"\u670d\u52a1\u5668\u5f00\u5c0f\u5dee\u5566"});case 11:return a.abrupt("return",!1);case 12:return a.next=14,p({type:"service/query/first/page"});case 14:case"end":return a.stop()}},a)})()},"service/delete"(e,t){return c.a.mark(function a(){var r,n,s,p,u,o,d;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload.values,n=t.race,s=t.call,p=t.put,u={id:r._id},a.next=5,n({data:s(l["a"],{method:"DELETE",path:"/api/resource/applications/:id",params:u}),timeout:s(i["delay"],1e4)});case 5:if(o=a.sent,d=o.timeout,!d){a.next=11;break}return a.next=10,p({type:"messages/tip/error",payload:"\u670d\u52a1\u5668\u5f00\u5c0f\u5dee\u5566"});case 10:return a.abrupt("return",!1);case 11:return a.next=13,p({type:"service/query/first/page"});case 13:case"end":return a.stop()}},a)})()},"service/query/first/page"(e,t){return c.a.mark(function e(){var a;return c.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.put,e.next=3,a({type:"service/query",payload:{page:1}});case 3:case"end":return e.stop()}},e)})()},"service/query/next/page"(e,t){return c.a.mark(function e(){var a,r,n,s;return c.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.select,r=t.put,e.next=3,a(e=>e[d["e"].namespace]);case 3:return n=e.sent,s=n.attributes,e.next=7,r({type:"service/query",payload:{page:s.pagination.current+1}});case 7:case"end":return e.stop()}},e)})()},"service/query/refresh/page"(e,t){return c.a.mark(function e(){var a,r,n,s;return c.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.select,r=t.put,e.next=3,a(e=>e[d["e"].namespace]);case 3:return n=e.sent,s=n.attributes,e.next=7,r({type:"service/query",payload:{page:s.pagination.current}});case 7:case"end":return e.stop()}},e)})()},"service/query/pageSize"(e,t){return c.a.mark(function a(){var r,n,s,p,u,i;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload,n=t.select,s=t.put,r.current,p=r.pageSize,a.next=5,n(e=>e[d["e"].namespace]);case 5:return u=a.sent,i=u.attributes,a.next=9,s({type:"save",payload:{attributes:Object(o["a"])(i,e=>{e.pagination.current=1,e.pagination.pageSize=p})}});case 9:return a.next=11,s({type:"service/query",payload:{page:1}});case 11:case"end":return a.stop()}},a)})()}},subscriptions:{setup(e){var t=e.dispatch,a=e.history;return a.listen(e=>{var a=e.pathname;doreamon.route.match(d["e"].path,a)&&t({type:"service/query/first/page"})})}}}}}]);