(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[22],{oJJ9:function(e,t,a){"use strict";a.r(t);var r=a("Y/ft"),n=a.n(r),s=a("d6i3"),c=a.n(s),u=a("p0pE"),i=a.n(u),p=a("gE9T"),o=a("V/h/"),d=a("sy1d"),l=a("6Jga");t["default"]={namespace:l["e"],state:{attributes:{actions:l["a"],forms:l["d"],confirms:l["b"],filters:l["c"],tables:l["g"],pagination:{pageSizeOptions:["5","10","20"],current:1,pageSize:10,total:1}},datasets:{table:[]},constraints:{filters:{},orderBy:[]}},reducers:{save:(e,t)=>{var a=t.payload;return i()({},e,a)}},effects:{dispatcher(e,t){return c.a.mark(function a(){var r,n,s,u,i,p,o,d,l;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:if(r=e.payload,n=t.put,s=r||{},u=s.meta,i=void 0===u?{}:u,p=s.data,o=void 0===p?{}:p,d=i.effectType,l=void 0===d?"dialog":d,!i.effect){a.next=9;break}return a.next=7,n({type:i.effect,payload:o});case 7:a.next=11;break;case 9:return a.next=11,n({type:"".concat(l,"/").concat(i.key),payload:o});case 11:case"end":return a.stop()}},a)})()},"dialog/create"(e,t){return c.a.mark(function a(){var r,s,u,p,o,d,y;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload,s=t.select,u=t.put,a.next=4,s(e=>e[l["e"]]);case 4:return p=a.sent,o=p.attributes,d="create",r.values,r.initialValue,y=n()(r,["values","initialValue"]),a.next=10,u({type:"forms/open",payload:{attributes:i()({},o.forms[d],{target:{namespace:l["e"],effect:"service/create"}}),datasets:y}});case 10:case"end":return a.stop()}},a)})()},"dialog/update"(e,t){return c.a.mark(function a(){var r,n,s,u,p,o;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload.record,n=t.select,s=t.put,a.next=4,n(e=>e[l["e"]]);case 4:return u=a.sent,p=u.attributes,o="update",a.next=9,s({type:"forms/open",payload:{attributes:i()({},p.forms[o],{target:{namespace:l["e"],effect:"service/update"}}),datasets:r}});case 9:case"end":return a.stop()}},a)})()},"dialog/delete"(e,t){return c.a.mark(function a(){var r,n,s,u,p,o;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return e.type,r=e.payload.record,n=t.select,s=t.put,a.next=4,n(e=>e[l["e"]]);case 4:return u=a.sent,p=u.attributes,o="delete",a.next=9,s({type:"confirms/open",payload:{attributes:i()({},p.confirms[o],{target:{namespace:l["e"],effect:"service/delete"}}),datasets:r}});case 9:case"end":return a.stop()}},a)})()},"service/query"(e,t){return c.a.mark(function a(){var r,n,s,u,y,f,v,x,g,m,w,b,h,k,q,z,S;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload,n=r.page,s=r.values,u=t.select,y=t.race,f=t.call,v=t.put,a.next=4,u(e=>e[l["e"]]);case 4:if(x=a.sent,!s){a.next=8;break}return a.next=8,v({type:"save",payload:{constraints:Object(o["a"])(x.constraints,e=>{e.filters=s})}});case 8:return a.next=10,u(e=>e[l["e"]]);case 10:return g=a.sent,m=g.attributes,w=g.datasets,b=g.constraints,h=m.pagination,k=n||h.current,a.next=18,y({data:f(d["a"],{method:"GET",path:"/api/resource/configs",query:i()({type:"table",page:k,pageSize:h.pageSize},b.filters)}),timeout:f(p["delay"],1e4)});case 18:if(q=a.sent,z=q.data,S=q.timeout,!S){a.next=25;break}return a.next=24,v({type:"messages/notice/error",payload:"\u670d\u52a1\u5668\u5f00\u5c0f\u5dee\u5566"});case 24:return a.abrupt("return",!1);case 25:return a.next=27,v({type:"save",payload:{attributes:Object(o["a"])(m,e=>{e.pagination.current=k,e.pagination.total=z.total}),datasets:Object(o["a"])(w,e=>{e.table=z.data})}});case 27:case"end":return a.stop()}},a)})()},"service/create"(e,t){return c.a.mark(function a(){var r,n,s,u,o,l,y;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload,n=t.race,s=t.call,u=t.put,o=i()({},r),a.next=5,n({data:s(d["a"],{method:"POST",path:"/api/resource/configs",query:{type:"table"},body:o}),timeout:s(p["delay"],1e4)});case 5:if(l=a.sent,l.data,y=l.timeout,!y){a.next=12;break}return a.next=11,u({type:"messages/tip/error",payload:"\u670d\u52a1\u5668\u5f00\u5c0f\u5dee\u5566"});case 11:return a.abrupt("return",!1);case 12:return a.next=14,u({type:"messages/tip/success",payload:"\u521b\u5efa\u6210\u529f"});case 14:return a.next=16,u({type:"service/query/first/page",payload:r});case 16:case"end":return a.stop()}},a)})()},"service/update"(e,t){return c.a.mark(function a(){var r,n,s,u,i,o,l;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload,n=t.race,s=t.call,u=t.put,i={id:r._id},console.log("fuck:",r,i),a.next=6,n({data:s(d["a"],{method:"PUT",path:"/api/resource/configs/:id",params:i,query:{type:"table"},body:r}),timeout:s(p["delay"],1e4)});case 6:if(o=a.sent,l=o.timeout,!l){a.next=12;break}return a.next=11,u({type:"messages/tip/error",payload:"\u670d\u52a1\u5668\u5f00\u5c0f\u5dee\u5566"});case 11:return a.abrupt("return",!1);case 12:return a.next=14,u({type:"messages/tip/success",payload:"\u66f4\u65b0\u6210\u529f"});case 14:return a.next=16,u({type:"service/query/first/page",payload:r});case 16:case"end":return a.stop()}},a)})()},"service/delete"(e,t){return c.a.mark(function a(){var r,n,s,u,i,o,l;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload,n=t.race,s=t.call,u=t.put,i={id:r._id},a.next=5,n({data:s(d["a"],{method:"DELETE",path:"/api/resource/configs/:id",params:i,query:{type:"table"}}),timeout:s(p["delay"],1e4)});case 5:if(o=a.sent,l=o.timeout,!l){a.next=11;break}return a.next=10,u({type:"messages/tip/error",payload:"\u670d\u52a1\u5668\u5f00\u5c0f\u5dee\u5566"});case 10:return a.abrupt("return",!1);case 11:return a.next=13,u({type:"messages/tip/success",payload:"\u5220\u9664\u6210\u529f"});case 13:return a.next=15,u({type:"service/query/first/page",payload:r});case 15:case"end":return a.stop()}},a)})()},"service/query/first/page"(e,t){return c.a.mark(function e(){var a;return c.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.put,e.next=3,a({type:"service/query",payload:{page:1}});case 3:case"end":return e.stop()}},e)})()},"service/query/refresh/page"(e,t){return c.a.mark(function e(){var a,r,n,s;return c.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.select,r=t.put,e.next=3,a(e=>e[l["e"]]);case 3:return n=e.sent,s=n.attributes,e.next=7,r({type:"service/query",payload:{page:s.pagination.current}});case 7:case"end":return e.stop()}},e)})()},"service/query/pageSize"(e,t){return c.a.mark(function a(){var r,n,s,u,i,p;return c.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:return r=e.payload,n=t.select,s=t.put,r.current,u=r.pageSize,a.next=5,n(e=>e[l["e"]]);case 5:return i=a.sent,p=i.attributes,a.next=9,s({type:"save",payload:{attributes:Object(o["a"])(p,e=>{e.pagination.current=1,e.pagination.pageSize=u})}});case 9:return a.next=11,s({type:"service/query",payload:{page:1}});case 11:case"end":return a.stop()}},a)})()},initialize(e,t){return c.a.mark(function e(){var a,r;return c.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.put,r=t.take,e.next=3,a({type:"service/query/first/page"});case 3:return e.next=5,r("service/query");case 5:case"end":return e.stop()}},e)})()}},subscriptions:{setup(e){var t=e.dispatch,a=e.history;return a.listen(e=>{var a=e.pathname;a==="/".concat(l["f"])&&t({type:"initialize"})})}}}}}]);